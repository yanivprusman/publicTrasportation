{"ast":null,"code":"import axios from 'axios';\nconst GTFS_BASE_URL = '/api/gtfs'; // URL to your GTFS data API\n\n// Mockup data for development until the backend is ready\nconst MOCK_STOPS = [{\n  stopId: '26472',\n  stopName: 'מסוף עמידר',\n  lat: 32.06948949599059,\n  lon: 34.83984033547383\n}, {\n  stopId: '20832',\n  stopName: 'גבעת שמואל',\n  lat: 32.06764959792775,\n  lon: 34.7867112130343\n}, {\n  stopId: '20834',\n  stopName: 'רמת גן',\n  lat: 32.08012,\n  lon: 34.81044\n}];\nconst MOCK_ROUTES = [{\n  routeId: '9141',\n  routeShortName: '60',\n  routeLongName: 'פתח תקוה - תל אביב'\n}, {\n  routeId: '9142',\n  routeShortName: '61',\n  routeLongName: 'בני ברק - תל אביב'\n}];\n\n/**\n * Load stop information from GTFS data\n * @returns {Promise<Array>} List of stops\n */\nexport async function getStops() {\n  try {\n    // Try to get data from the API\n    const response = await axios.get(`${GTFS_BASE_URL}/stops`);\n    return Array.isArray(response.data) ? response.data : MOCK_STOPS;\n  } catch (error) {\n    console.error('Error fetching GTFS stops:', error);\n    console.log('Using mock data instead');\n    // Return mock data if API is not available\n    return MOCK_STOPS;\n  }\n}\n\n/**\n * Load route information from GTFS data\n * @returns {Promise<Array>} List of routes\n */\nexport async function getRoutes() {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/routes`);\n    return Array.isArray(response.data) ? response.data : MOCK_ROUTES;\n  } catch (error) {\n    console.error('Error fetching GTFS routes:', error);\n    console.log('Using mock data instead');\n    return MOCK_ROUTES;\n  }\n}\n\n/**\n * Get scheduled departures for a stop\n * @param {string} stopId - The stop ID\n * @returns {Promise<Array>} List of scheduled departures\n */\nexport async function getScheduledDepartures(stopId) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/departures?stop=${stopId}`);\n    return Array.isArray(response.data) ? response.data : [];\n  } catch (error) {\n    console.error(`Error fetching scheduled departures for stop ${stopId}:`, error);\n    // Return mock data for development\n    return [{\n      tripId: \"20925867\",\n      routeId: \"9141\",\n      lineNumber: \"60\",\n      destination: \"תל אביב\",\n      scheduledArrival: new Date(Date.now() + 600000).toISOString() // 10 minutes from now\n    }, {\n      tripId: \"20925868\",\n      routeId: \"9142\",\n      lineNumber: \"61\",\n      destination: \"בני ברק\",\n      scheduledArrival: new Date(Date.now() + 1200000).toISOString() // 20 minutes from now\n    }];\n  }\n}\n\n/**\n * Search for stops by name\n * @param {string} query - Search query\n * @returns {Promise<Array>} List of matching stops\n */\nexport async function searchStops(query) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/stops/search?q=${encodeURIComponent(query)}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error searching stops:', error);\n    return [];\n  }\n}\n\n/**\n * Get route shape (geometry)\n * @param {string} routeId - The route ID\n * @returns {Promise<Array>} List of coordinates forming the route shape\n */\nexport async function getRouteShape(routeId) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/shapes?route=${routeId}`);\n    return Array.isArray(response.data) ? response.data : [];\n  } catch (error) {\n    console.error(`Error fetching shape for route ${routeId}:`, error);\n    // Return mock shape data\n    if (routeId === '9141') {\n      return [[32.06948949599059, 34.83984033547383],\n      // Starting point\n      [32.06856, 34.82541],\n      // Point in between\n      [32.06764959792775, 34.7867112130343] // Destination\n      ];\n    }\n    return [];\n  }\n}","map":{"version":3,"names":["axios","GTFS_BASE_URL","MOCK_STOPS","stopId","stopName","lat","lon","MOCK_ROUTES","routeId","routeShortName","routeLongName","getStops","response","get","Array","isArray","data","error","console","log","getRoutes","getScheduledDepartures","tripId","lineNumber","destination","scheduledArrival","Date","now","toISOString","searchStops","query","encodeURIComponent","getRouteShape"],"sources":["/home/yaniv/101_coding/publicTransportation/react/public-transportation/src/services/gtfs-service.js"],"sourcesContent":["import axios from 'axios';\n\nconst GTFS_BASE_URL = '/api/gtfs'; // URL to your GTFS data API\n\n// Mockup data for development until the backend is ready\nconst MOCK_STOPS = [\n  { stopId: '26472', stopName: 'מסוף עמידר', lat: 32.06948949599059, lon: 34.83984033547383 },\n  { stopId: '20832', stopName: 'גבעת שמואל', lat: 32.06764959792775, lon: 34.7867112130343 },\n  { stopId: '20834', stopName: 'רמת גן', lat: 32.08012, lon: 34.81044 }\n];\n\nconst MOCK_ROUTES = [\n  { routeId: '9141', routeShortName: '60', routeLongName: 'פתח תקוה - תל אביב' },\n  { routeId: '9142', routeShortName: '61', routeLongName: 'בני ברק - תל אביב' },\n];\n\n/**\n * Load stop information from GTFS data\n * @returns {Promise<Array>} List of stops\n */\nexport async function getStops() {\n  try {\n    // Try to get data from the API\n    const response = await axios.get(`${GTFS_BASE_URL}/stops`);\n    return Array.isArray(response.data) ? response.data : MOCK_STOPS;\n  } catch (error) {\n    console.error('Error fetching GTFS stops:', error);\n    console.log('Using mock data instead');\n    // Return mock data if API is not available\n    return MOCK_STOPS;\n  }\n}\n\n/**\n * Load route information from GTFS data\n * @returns {Promise<Array>} List of routes\n */\nexport async function getRoutes() {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/routes`);\n    return Array.isArray(response.data) ? response.data : MOCK_ROUTES;\n  } catch (error) {\n    console.error('Error fetching GTFS routes:', error);\n    console.log('Using mock data instead');\n    return MOCK_ROUTES;\n  }\n}\n\n/**\n * Get scheduled departures for a stop\n * @param {string} stopId - The stop ID\n * @returns {Promise<Array>} List of scheduled departures\n */\nexport async function getScheduledDepartures(stopId) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/departures?stop=${stopId}`);\n    return Array.isArray(response.data) ? response.data : [];\n  } catch (error) {\n    console.error(`Error fetching scheduled departures for stop ${stopId}:`, error);\n    // Return mock data for development\n    return [\n      {\n        tripId: \"20925867\",\n        routeId: \"9141\",\n        lineNumber: \"60\",\n        destination: \"תל אביב\",\n        scheduledArrival: new Date(Date.now() + 600000).toISOString(), // 10 minutes from now\n      },\n      {\n        tripId: \"20925868\",\n        routeId: \"9142\",\n        lineNumber: \"61\",\n        destination: \"בני ברק\",\n        scheduledArrival: new Date(Date.now() + 1200000).toISOString(), // 20 minutes from now\n      }\n    ];\n  }\n}\n\n/**\n * Search for stops by name\n * @param {string} query - Search query\n * @returns {Promise<Array>} List of matching stops\n */\nexport async function searchStops(query) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/stops/search?q=${encodeURIComponent(query)}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error searching stops:', error);\n    return [];\n  }\n}\n\n/**\n * Get route shape (geometry)\n * @param {string} routeId - The route ID\n * @returns {Promise<Array>} List of coordinates forming the route shape\n */\nexport async function getRouteShape(routeId) {\n  try {\n    const response = await axios.get(`${GTFS_BASE_URL}/shapes?route=${routeId}`);\n    return Array.isArray(response.data) ? response.data : [];\n  } catch (error) {\n    console.error(`Error fetching shape for route ${routeId}:`, error);\n    // Return mock shape data\n    if (routeId === '9141') {\n      return [\n        [32.06948949599059, 34.83984033547383],  // Starting point\n        [32.06856, 34.82541],                   // Point in between\n        [32.06764959792775, 34.7867112130343]    // Destination\n      ];\n    }\n    return [];\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}