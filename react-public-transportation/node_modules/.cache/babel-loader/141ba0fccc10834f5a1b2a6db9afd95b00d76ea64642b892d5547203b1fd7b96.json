{"ast":null,"code":"var _jsxFileName = \"/home/yaniv/101_coding/publicTransportation/react/public-transportation/src/MapView.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useMemo } from 'react';\nimport './App.css';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport axios from 'axios';\nimport { TrackMapMovement, UpdateMapView, fetchAddress } from './components/map/MapUtilities';\nimport { configureDefaultLeafletIcons, destinationIcon, centerIcon, vehicleIcon, stopIcon } from './components/map/MapMarkers';\nimport MapControls from './components/map/MapControls';\nimport { simplifyShape } from './utils/ShapeSimplifier';\nimport useMapHandlers from './hooks/useMapHandlers';\nimport RouteMapView from './components/map/RouteMapView';\n\n// Configure default Leaflet icons\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconfigureDefaultLeafletIcons();\nfunction MapView({\n  latitude,\n  longitude,\n  destination,\n  onDestinationSet,\n  startingPoint,\n  mapCenter: initialMapCenter,\n  setMapCenter,\n  vehicleMarkers = [],\n  routeShape = null,\n  stops = [],\n  selectedStop = null,\n  center,\n  defaultStartingPoint,\n  defaultDestination,\n  calculateRoute,\n  onRouteCalculated\n}) {\n  _s();\n  var _mapCenter$, _mapCenter$2;\n  // Use default starting point if provided\n  const [position, setPosition] = useState(defaultStartingPoint || [latitude, longitude]);\n  const [route, setRoute] = useState(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [mapCenter, setMapCenterLocal] = useState(center || initialMapCenter || [latitude, longitude]);\n  const [showRoutePanel, setShowRoutePanel] = useState(false);\n\n  // Update external map center when local state changes\n  useEffect(() => {\n    if (setMapCenter) {\n      setMapCenter(mapCenter);\n    }\n  }, [mapCenter, setMapCenter]);\n\n  // Set the default destination if provided and no destination is set\n  useEffect(() => {\n    if (defaultDestination && (!destination || !destination[0])) {\n      onDestinationSet(defaultDestination);\n    }\n  }, [defaultDestination, destination, onDestinationSet]);\n\n  // Use custom hook for map handlers\n  const {\n    searchQuery,\n    setSearchQuery,\n    searchError,\n    positionAddress,\n    destinationAddress,\n    setPositionAddress,\n    setDestinationAddress,\n    handleSearch,\n    handleSetStartPoint,\n    handleSetDestinationPoint,\n    handleKeyPress,\n    handleFindRoute\n  } = useMapHandlers(position, destination, onDestinationSet, setMapCenterLocal, mapCenter);\n\n  // Memoize and simplify the route shape to improve performance\n  const optimizedRouteShape = useMemo(() => {\n    if (!routeShape || !Array.isArray(routeShape) || routeShape.length < 3) {\n      return routeShape;\n    }\n    console.log(`Simplifying route shape with ${routeShape.length} points...`);\n\n    // Determine if we need to simplify (only for large routes)\n    if (routeShape.length > 300) {\n      // Stronger simplification for very large routes\n      const factor = routeShape.length > 1000 ? 0.00015 : 0.0001;\n      const simplified = simplifyShape(routeShape, factor);\n      console.log(`Simplified to ${simplified.length} points (${Math.round(simplified.length / routeShape.length * 100)}%)`);\n      return simplified;\n    }\n    return routeShape;\n  }, [routeShape]);\n\n  // Log routeShape when it changes to debug\n  useEffect(() => {\n    if (routeShape) {\n      console.log(\"Route shape received in MapView:\", routeShape.length, \"points\");\n      console.log(\"First point:\", routeShape[0]);\n      console.log(\"Last point:\", routeShape[routeShape.length - 1]);\n    }\n  }, [routeShape]);\n\n  // When destination changes, ensure it's properly set\n  useEffect(() => {\n    if (destination && Array.isArray(destination) && destination.length === 2) {\n      // Destination is valid\n      fetchAddress(destination[0], destination[1], setDestinationAddress);\n    }\n  }, [destination]);\n\n  // When position changes\n  useEffect(() => {\n    if (position && Array.isArray(position) && position.length === 2) {\n      fetchAddress(position[0], position[1], setPositionAddress);\n    }\n  }, [position]);\n\n  // Add effect to respond to calculateRoute changes\n  useEffect(() => {\n    if (calculateRoute && position && destination) {\n      // Actually calculate the route using the position as starting point\n      handleFindRouteClick();\n\n      // Let parent know we've processed the request\n      if (onRouteCalculated) {\n        onRouteCalculated();\n      }\n    }\n  }, [calculateRoute, position, destination]);\n\n  // If we have a proper route shape, show the route panel with RouteMapView\n  const handleShowRoutePanel = () => {\n    if (optimizedRouteShape && optimizedRouteShape.length > 0) {\n      setShowRoutePanel(true);\n    }\n  };\n\n  // Handle clicking the \"Find Route\" button\n  const handleFindRouteClick = async () => {\n    if (destination) {\n      // Make sure we're using the current user position, not map center\n      console.log(\"Finding route from user position to destination\");\n      const routeData = await handleFindRoute();\n      if (routeData) {\n        setRoute(routeData);\n        console.log(\"Setting route with\", routeData.length, \"points from\", position, \"to\", destination);\n      }\n    } else {\n      console.error(\"No destination set\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '100vh',\n      width: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(MapControls, {\n      searchQuery: searchQuery,\n      setSearchQuery: setSearchQuery,\n      handleSearch: handleSearch,\n      handleKeyPress: handleKeyPress,\n      handleSetStartPoint: handleSetStartPoint,\n      handleSetDestinationPoint: handleSetDestinationPoint,\n      handleFindRoute: handleFindRouteClick,\n      searchError: searchError,\n      positionAddress: positionAddress,\n      destinationAddress: destinationAddress\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this), (showRoutePanel || optimizedRouteShape) && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '10px',\n        right: '10px',\n        background: 'white',\n        padding: '10px',\n        zIndex: 1000,\n        width: '300px',\n        boxShadow: '0 0 10px rgba(0,0,0,0.2)',\n        borderRadius: '5px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Route Shape View\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowRoutePanel(false),\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: '300px',\n          marginTop: '10px'\n        },\n        children: /*#__PURE__*/_jsxDEV(RouteMapView, {\n          routeShape: optimizedRouteShape\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 9\n    }, this), !showRoutePanel && optimizedRouteShape && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleShowRoutePanel,\n      style: {\n        position: 'absolute',\n        bottom: '20px',\n        right: '20px',\n        zIndex: 1000,\n        padding: '10px',\n        background: 'blue',\n        color: 'white',\n        border: 'none',\n        borderRadius: '5px'\n      },\n      children: \"Show Route Panel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: mapCenter,\n      zoom: 13,\n      style: {\n        height: '100%',\n        width: '100%'\n      },\n      zoomControl: false,\n      whenReady: () => setMapReady(true),\n      preferCanvas: true // Use canvas renderer for better performance\n      ,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UpdateMapView, {\n        position: mapCenter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TrackMapMovement, {\n        setMapCenter: setMapCenterLocal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Marker, {\n        position: position,\n        icon: L.icon({\n          iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',\n          iconRetinaUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',\n          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n          iconSize: [25, 41],\n          iconAnchor: [12, 41]\n        }),\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Starting Point:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this), \" \", positionAddress, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 63\n          }, this), \"Coordinates: \", position[0].toFixed(6), \", \", position[1].toFixed(6)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), destination && /*#__PURE__*/_jsxDEV(Marker, {\n        position: destination,\n        icon: destinationIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Destination:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 17\n            }, this), \" \", destinationAddress, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 67\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Coordinates:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 17\n            }, this), \" \", destination[0].toFixed(6), \", \", destination[1].toFixed(6)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Marker, {\n        position: mapCenter,\n        icon: centerIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Map Center:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this), \" \", Array.isArray(mapCenter) ? `${(_mapCenter$ = mapCenter[0]) === null || _mapCenter$ === void 0 ? void 0 : _mapCenter$.toFixed(6)}, ${(_mapCenter$2 = mapCenter[1]) === null || _mapCenter$2 === void 0 ? void 0 : _mapCenter$2.toFixed(6)}` : 'Invalid coordinates']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), route && route.length > 0 && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: route,\n        pathOptions: {\n          color: 'blue',\n          weight: 4,\n          opacity: 0.8\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 11\n      }, this), vehicleMarkers.map((vehicle, index) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: vehicle.position,\n        icon: vehicleIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Line:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 17\n            }, this), \" \", vehicle.lineNumber, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 60\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Vehicle:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 17\n            }, this), \" \", vehicle.vehicleRef, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 63\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Expected arrival:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 17\n            }, this), \" \", vehicle.expectedArrival, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 77\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Distance from stop:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 17\n            }, this), \" \", vehicle.distanceFromStop, \" m\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this)\n      }, `vehicle-${index}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }, this)), optimizedRouteShape && optimizedRouteShape.length > 0 && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: optimizedRouteShape,\n        pathOptions: {\n          color: 'red',\n          weight: 3,\n          opacity: 0.7,\n          dashArray: '5, 5',\n          lineCap: 'round'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }, this), stops.map(stop => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [stop.lat, stop.lon],\n        icon: stop.stopId === selectedStop ? centerIcon : stopIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Stop:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 17\n            }, this), \" \", stop.stopName, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 55\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"ID:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 17\n            }, this), \" \", stop.stopId, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 51\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSetStartPoint([stop.lat, stop.lon]),\n              children: \"Set as starting point\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, this)\n      }, `stop-${stop.stopId}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n}\n_s(MapView, \"6z6VedLGwKxppeOx/ALofr2PgpE=\", false, function () {\n  return [useMapHandlers];\n});\n_c = MapView;\nexport default MapView;\nvar _c;\n$RefreshReg$(_c, \"MapView\");","map":{"version":3,"names":["useEffect","useState","useMemo","MapContainer","TileLayer","Marker","Popup","Polyline","L","axios","TrackMapMovement","UpdateMapView","fetchAddress","configureDefaultLeafletIcons","destinationIcon","centerIcon","vehicleIcon","stopIcon","MapControls","simplifyShape","useMapHandlers","RouteMapView","jsxDEV","_jsxDEV","MapView","latitude","longitude","destination","onDestinationSet","startingPoint","mapCenter","initialMapCenter","setMapCenter","vehicleMarkers","routeShape","stops","selectedStop","center","defaultStartingPoint","defaultDestination","calculateRoute","onRouteCalculated","_s","_mapCenter$","_mapCenter$2","position","setPosition","route","setRoute","mapReady","setMapReady","setMapCenterLocal","showRoutePanel","setShowRoutePanel","searchQuery","setSearchQuery","searchError","positionAddress","destinationAddress","setPositionAddress","setDestinationAddress","handleSearch","handleSetStartPoint","handleSetDestinationPoint","handleKeyPress","handleFindRoute","optimizedRouteShape","Array","isArray","length","console","log","factor","simplified","Math","round","handleFindRouteClick","handleShowRoutePanel","routeData","error","style","height","width","children","fileName","_jsxFileName","lineNumber","columnNumber","top","right","background","padding","zIndex","boxShadow","borderRadius","onClick","marginTop","bottom","color","border","zoom","zoomControl","whenReady","preferCanvas","url","attribution","icon","iconUrl","iconRetinaUrl","shadowUrl","iconSize","iconAnchor","toFixed","positions","pathOptions","weight","opacity","map","vehicle","index","vehicleRef","expectedArrival","distanceFromStop","dashArray","lineCap","stop","lat","lon","stopId","stopName","_c","$RefreshReg$"],"sources":["/home/yaniv/101_coding/publicTransportation/react/public-transportation/src/MapView.js"],"sourcesContent":["import { useEffect, useState, useMemo } from 'react';\nimport './App.css';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport axios from 'axios';\nimport { TrackMapMovement, UpdateMapView, fetchAddress } from './components/map/MapUtilities';\nimport { configureDefaultLeafletIcons, destinationIcon, centerIcon, vehicleIcon, stopIcon } from './components/map/MapMarkers';\nimport MapControls from './components/map/MapControls';\nimport { simplifyShape } from './utils/ShapeSimplifier';\nimport useMapHandlers from './hooks/useMapHandlers';\nimport RouteMapView from './components/map/RouteMapView';\n\n// Configure default Leaflet icons\nconfigureDefaultLeafletIcons();\n\nfunction MapView({ \n  latitude, \n  longitude, \n  destination, \n  onDestinationSet, \n  startingPoint,\n  mapCenter: initialMapCenter,\n  setMapCenter,\n  vehicleMarkers = [],\n  routeShape = null,\n  stops = [],\n  selectedStop = null,\n  center,\n  defaultStartingPoint,\n  defaultDestination,\n  calculateRoute,\n  onRouteCalculated\n}) {\n  // Use default starting point if provided\n  const [position, setPosition] = useState(defaultStartingPoint || [latitude, longitude]);\n  const [route, setRoute] = useState(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [mapCenter, setMapCenterLocal] = useState(center || initialMapCenter || [latitude, longitude]);\n  const [showRoutePanel, setShowRoutePanel] = useState(false);\n\n  // Update external map center when local state changes\n  useEffect(() => {\n    if (setMapCenter) {\n      setMapCenter(mapCenter);\n    }\n  }, [mapCenter, setMapCenter]);\n\n  // Set the default destination if provided and no destination is set\n  useEffect(() => {\n    if (defaultDestination && (!destination || !destination[0])) {\n      onDestinationSet(defaultDestination);\n    }\n  }, [defaultDestination, destination, onDestinationSet]);\n\n  // Use custom hook for map handlers\n  const {\n    searchQuery,\n    setSearchQuery,\n    searchError,\n    positionAddress,\n    destinationAddress,\n    setPositionAddress,\n    setDestinationAddress,\n    handleSearch,\n    handleSetStartPoint,\n    handleSetDestinationPoint,\n    handleKeyPress,\n    handleFindRoute\n  } = useMapHandlers(position, destination, onDestinationSet, setMapCenterLocal, mapCenter);\n\n  // Memoize and simplify the route shape to improve performance\n  const optimizedRouteShape = useMemo(() => {\n    if (!routeShape || !Array.isArray(routeShape) || routeShape.length < 3) {\n      return routeShape;\n    }\n    \n    console.log(`Simplifying route shape with ${routeShape.length} points...`);\n    \n    // Determine if we need to simplify (only for large routes)\n    if (routeShape.length > 300) {\n      // Stronger simplification for very large routes\n      const factor = routeShape.length > 1000 ? 0.00015 : 0.0001;\n      const simplified = simplifyShape(routeShape, factor);\n      console.log(`Simplified to ${simplified.length} points (${Math.round(simplified.length/routeShape.length*100)}%)`);\n      return simplified;\n    }\n    \n    return routeShape;\n  }, [routeShape]);\n\n  // Log routeShape when it changes to debug\n  useEffect(() => {\n    if (routeShape) {\n      console.log(\"Route shape received in MapView:\", routeShape.length, \"points\");\n      console.log(\"First point:\", routeShape[0]);\n      console.log(\"Last point:\", routeShape[routeShape.length - 1]);\n    }\n  }, [routeShape]);\n\n  // When destination changes, ensure it's properly set\n  useEffect(() => {\n    if (destination && Array.isArray(destination) && destination.length === 2) {\n      // Destination is valid\n      fetchAddress(destination[0], destination[1], setDestinationAddress);\n    }\n  }, [destination]);\n\n  // When position changes\n  useEffect(() => {\n    if (position && Array.isArray(position) && position.length === 2) {\n      fetchAddress(position[0], position[1], setPositionAddress);\n    }\n  }, [position]);\n\n  // Add effect to respond to calculateRoute changes\n  useEffect(() => {\n    if (calculateRoute && position && destination) {\n      // Actually calculate the route using the position as starting point\n      handleFindRouteClick();\n      \n      // Let parent know we've processed the request\n      if (onRouteCalculated) {\n        onRouteCalculated();\n      }\n    }\n  }, [calculateRoute, position, destination]);\n\n  // If we have a proper route shape, show the route panel with RouteMapView\n  const handleShowRoutePanel = () => {\n    if (optimizedRouteShape && optimizedRouteShape.length > 0) {\n      setShowRoutePanel(true);\n    }\n  };\n\n  // Handle clicking the \"Find Route\" button\n  const handleFindRouteClick = async () => {\n    if (destination) {\n      // Make sure we're using the current user position, not map center\n      console.log(\"Finding route from user position to destination\");\n      const routeData = await handleFindRoute();\n      if (routeData) {\n        setRoute(routeData);\n        console.log(\"Setting route with\", routeData.length, \"points from\", position, \"to\", destination);\n      }\n    } else {\n      console.error(\"No destination set\");\n    }\n  };\n\n  return (\n    <div style={{ height: '100vh', width: '100%' }}>\n      <MapControls \n        searchQuery={searchQuery}\n        setSearchQuery={setSearchQuery}\n        handleSearch={handleSearch}\n        handleKeyPress={handleKeyPress}\n        handleSetStartPoint={handleSetStartPoint}\n        handleSetDestinationPoint={handleSetDestinationPoint}\n        handleFindRoute={handleFindRouteClick}\n        searchError={searchError}\n        positionAddress={positionAddress}\n        destinationAddress={destinationAddress}\n      />\n      \n      {/* Route panel for showing the shape */}\n      {(showRoutePanel || optimizedRouteShape) && (\n        <div style={{\n          position: 'absolute',\n          top: '10px',\n          right: '10px',\n          background: 'white',\n          padding: '10px',\n          zIndex: 1000,\n          width: '300px',\n          boxShadow: '0 0 10px rgba(0,0,0,0.2)',\n          borderRadius: '5px'\n        }}>\n          <h3>Route Shape View</h3>\n          <button onClick={() => setShowRoutePanel(false)}>Close</button>\n          <div style={{ height: '300px', marginTop: '10px' }}>\n            <RouteMapView routeShape={optimizedRouteShape} />\n          </div>\n        </div>\n      )}\n      \n      {!showRoutePanel && optimizedRouteShape && (\n        <button \n          onClick={handleShowRoutePanel}\n          style={{\n            position: 'absolute',\n            bottom: '20px',\n            right: '20px',\n            zIndex: 1000,\n            padding: '10px',\n            background: 'blue',\n            color: 'white',\n            border: 'none',\n            borderRadius: '5px'\n          }}\n        >\n          Show Route Panel\n        </button>\n      )}\n      \n      <MapContainer \n        center={mapCenter} \n        zoom={13} \n        style={{ height: '100%', width: '100%' }} \n        zoomControl={false}\n        whenReady={() => setMapReady(true)}\n        preferCanvas={true} // Use canvas renderer for better performance\n      >\n        <TileLayer\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        <UpdateMapView position={mapCenter} />\n        <TrackMapMovement setMapCenter={setMapCenterLocal} />\n        \n        {/* User position marker - Make it more visible */}\n        <Marker position={position} icon={L.icon({\n          iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',\n          iconRetinaUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',\n          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n          iconSize: [25, 41],\n          iconAnchor: [12, 41],\n        })}>\n          <Popup>\n            <strong>Starting Point:</strong> {positionAddress}<br/>\n            Coordinates: {position[0].toFixed(6)}, {position[1].toFixed(6)}\n          </Popup>\n        </Marker>\n        \n        {/* Destination marker */}\n        {destination && (\n          <Marker position={destination} icon={destinationIcon}>\n            <Popup>\n              <div>\n                <strong>Destination:</strong> {destinationAddress}<br/>\n                <strong>Coordinates:</strong> {destination[0].toFixed(6)}, {destination[1].toFixed(6)}\n              </div>\n            </Popup>\n          </Marker>\n        )}\n        \n        {/* Map center marker */}\n        <Marker position={mapCenter} icon={centerIcon}>\n          <Popup>\n            <div>\n              <strong>Map Center:</strong> {Array.isArray(mapCenter) ? `${mapCenter[0]?.toFixed(6)}, ${mapCenter[1]?.toFixed(6)}` : 'Invalid coordinates'}\n            </div>\n          </Popup>\n        </Marker>\n        \n        {/* Route display using the whole route */}\n        {route && route.length > 0 && (\n          <Polyline \n            positions={route} \n            pathOptions={{ \n              color: 'blue', \n              weight: 4, \n              opacity: 0.8 \n            }} \n          />\n        )}\n        \n        {/* Vehicle markers */}\n        {vehicleMarkers.map((vehicle, index) => (\n          <Marker \n            key={`vehicle-${index}`} \n            position={vehicle.position}\n            icon={vehicleIcon}\n          >\n            <Popup>\n              <div>\n                <strong>Line:</strong> {vehicle.lineNumber}<br/>\n                <strong>Vehicle:</strong> {vehicle.vehicleRef}<br/>\n                <strong>Expected arrival:</strong> {vehicle.expectedArrival}<br/>\n                <strong>Distance from stop:</strong> {vehicle.distanceFromStop} m\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n        \n        {/* Route shape if available */}\n        {optimizedRouteShape && optimizedRouteShape.length > 0 && (\n          <Polyline \n            positions={optimizedRouteShape} \n            pathOptions={{ \n              color: 'red', \n              weight: 3, \n              opacity: 0.7,\n              dashArray: '5, 5',\n              lineCap: 'round'\n            }} \n          />\n        )}\n        \n        {/* Stop markers */}\n        {stops.map(stop => (\n          <Marker \n            key={`stop-${stop.stopId}`} \n            position={[stop.lat, stop.lon]}\n            icon={stop.stopId === selectedStop ? centerIcon : stopIcon}\n          >\n            <Popup>\n              <div>\n                <strong>Stop:</strong> {stop.stopName}<br/>\n                <strong>ID:</strong> {stop.stopId}<br/>\n                <button onClick={() => handleSetStartPoint([stop.lat, stop.lon])}>\n                  Set as starting point\n                </button>\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n      </MapContainer>\n    </div>\n  );\n}\n\nexport default MapView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}