{"ast":null,"code":"var _jsxFileName = \"/home/yaniv/101_coding/publicTransportation/react/public-transportation/src/MapView.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useMemo } from 'react';\nimport './App.css';\nimport { MapContainer, TileLayer } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { TrackMapMovement, UpdateMapView, fetchAddress } from './components/map/MapUtilities';\nimport { configureDefaultLeafletIcons } from './components/map/MapMarkers';\nimport MapControls from './components/map/MapControls';\nimport useMapHandlers from './hooks/useMapHandlers';\nimport MapEffect from './components/map/MapEffect';\nimport RouteLayer from './components/map/RouteLayer';\nimport MarkersLayer from './components/map/MarkersLayer';\nimport MapControlPanel from './components/map/MapControlPanel';\n\n// Configure default Leaflet icons\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconfigureDefaultLeafletIcons();\nfunction MapView({\n  latitude,\n  longitude,\n  destination,\n  onDestinationSet,\n  startingPoint,\n  mapCenter: initialMapCenter,\n  setMapCenter,\n  vehicleMarkers = [],\n  routeShape = null,\n  stops = [],\n  selectedStop = null,\n  center,\n  defaultStartingPoint,\n  defaultDestination,\n  calculateRoute,\n  onRouteCalculated\n}) {\n  _s();\n  // Use default starting point if provided\n  const [position, setPosition] = useState(defaultStartingPoint || [latitude, longitude]);\n  const [route, setRoute] = useState(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [mapCenter, setMapCenterLocal] = useState(center || initialMapCenter || [latitude, longitude]);\n  const [showRoutePanel, setShowRoutePanel] = useState(false);\n  // Add state for middle point\n  const [middlePoint, setMiddlePoint] = useState(null);\n\n  // Update external map center when local state changes\n  useEffect(() => {\n    if (setMapCenter) {\n      setMapCenter(mapCenter);\n    }\n  }, [mapCenter, setMapCenter]);\n\n  // Set the default destination if provided and no destination is set\n  useEffect(() => {\n    if (defaultDestination && (!destination || !destination[0])) {\n      onDestinationSet(defaultDestination);\n    }\n  }, [defaultDestination, destination, onDestinationSet]);\n\n  // Use custom hook for map handlers\n  const {\n    searchQuery,\n    setSearchQuery,\n    searchError,\n    setSearchError,\n    // Add this line to extract setSearchError from the hook\n    positionAddress,\n    destinationAddress,\n    setPositionAddress,\n    setDestinationAddress,\n    handleSearch,\n    handleSetStartPoint,\n    handleSetDestinationPoint,\n    handleKeyPress,\n    handleFindRoute\n  } = useMapHandlers(position, setPosition, destination, onDestinationSet, setMapCenterLocal, mapCenter);\n\n  // When destination changes, ensure it's properly set\n  useEffect(() => {\n    if (destination && Array.isArray(destination) && destination.length === 2) {\n      // Destination is valid\n      fetchAddress(destination[0], destination[1], setDestinationAddress);\n    }\n  }, [destination]);\n\n  // When position changes\n  useEffect(() => {\n    if (position && Array.isArray(position) && position.length === 2) {\n      fetchAddress(position[0], position[1], setPositionAddress);\n    }\n  }, [position]);\n\n  // Add effect to respond to calculateRoute changes\n  useEffect(() => {\n    if (calculateRoute && position && destination) {\n      // Actually calculate the route using the position as starting point\n      handleFindRouteClick();\n\n      // Let parent know we've processed the request\n      if (onRouteCalculated) {\n        onRouteCalculated();\n      }\n    }\n  }, [calculateRoute, position, destination]);\n\n  // Log routeShape when it changes to debug\n  useEffect(() => {\n    if (routeShape) {\n      console.log(\"Route shape received in MapView:\", routeShape.length, \"points\");\n    }\n  }, [routeShape]);\n\n  // If we have a proper route shape, show the route panel with RouteMapView\n  const handleShowRoutePanel = () => {\n    if (routeShape && routeShape.length > 0) {\n      setShowRoutePanel(true);\n    }\n  };\n\n  // Handle clicking the \"Find Route\" button\n  const handleFindRouteClick = async () => {\n    if (destination) {\n      // Make sure we're using the current user position, not map center\n      console.log(\"Finding route from user position to destination\");\n      const routeData = await handleFindRoute();\n      if (routeData) {\n        setRoute(routeData);\n        console.log(\"Setting route with\", routeData.length, \"points from\", position, \"to\", destination);\n      }\n    } else {\n      console.error(\"No destination set\");\n    }\n  };\n\n  // Function to calculate and set the middle point of line 60's route\n  const handleShowMiddlePoint = async () => {\n    try {\n      setSearchError('Fetching Line 60 route data...');\n\n      // First approach: Use route shape points if available\n      if (routeShape && routeShape.length > 0) {\n        const middleIndex = Math.floor(routeShape.length / 2);\n        const calculatedMiddlePoint = routeShape[middleIndex];\n        setMiddlePoint(calculatedMiddlePoint);\n\n        // Log detailed information to console for debugging\n        console.group(\"Line 60 Middle Point Information\");\n        console.log(\"Middle point coordinates:\", calculatedMiddlePoint);\n        console.log(\"Total route points:\", routeShape.length);\n        console.log(\"Middle point index:\", middleIndex);\n        console.log(\"Method used: Route shape\");\n        console.groupEnd();\n\n        // Update map center to show the middle point\n        setMapCenterLocal(calculatedMiddlePoint);\n        return;\n      }\n\n      // Second approach: Fetch stops data for Line 60\n      const response = await fetch('/api/stops-data.php?line=60');\n      const data = await response.json();\n      if (data.stops && data.stops.length > 0) {\n        // Get the middle stop from the stops array\n        const stops = data.stops;\n        const middleIndex = Math.floor(stops.length / 2);\n        const middleStop = stops[middleIndex];\n        const calculatedMiddlePoint = [middleStop.lat, middleStop.lon];\n        setMiddlePoint(calculatedMiddlePoint);\n\n        // Log detailed information about the middle stop to console\n        console.group(\"Line 60 Middle Stop Information\");\n        console.log(\"Middle stop:\", middleStop.name);\n        console.log(\"Stop ID:\", middleStop.id);\n        console.log(\"Coordinates:\", calculatedMiddlePoint);\n        console.log(\"Stop sequence:\", middleStop.sequence);\n        console.log(\"Position in route:\", `${middleIndex + 1} of ${stops.length} stops`);\n        console.log(\"Method used: Stops data\");\n\n        // Log all stops for detailed analysis\n        console.log(\"All stops on route:\", stops);\n        console.groupEnd();\n\n        // Update map center to show the middle stop\n        setMapCenterLocal(calculatedMiddlePoint);\n      } else {\n        // Third approach: Hardcode known middle points for Line 60\n        const hardcodedMiddlePoint = [32.0729, 34.8046]; // Middle point for Line 60 in Ramat Gan\n        setMiddlePoint(hardcodedMiddlePoint);\n        console.group(\"Line 60 Middle Point Information\");\n        console.log(\"Middle point coordinates (hardcoded):\", hardcodedMiddlePoint);\n        console.log(\"Method used: Hardcoded coordinates\");\n        console.log(\"Note: This is an approximation as API data was unavailable\");\n        console.groupEnd();\n\n        // Update map center to show the hardcoded middle point\n        setMapCenterLocal(hardcodedMiddlePoint);\n      }\n    } catch (error) {\n      console.error('Error finding middle point:', error);\n      setSearchError('Error finding middle point');\n\n      // Still provide some fallback coordinates in case of error\n      const fallbackPoint = [32.0729, 34.8046]; // Known approximate middle point for Line 60\n      setMiddlePoint(fallbackPoint);\n      setMapCenterLocal(fallbackPoint);\n      setTimeout(() => setSearchError(null), 3000);\n    }\n  };\n\n  // Helper function to validate coordinates are in Israel\n  const isInIsrael = (lat, lon) => {\n    // Rough bounding box for Israel\n    return lat >= 29.5 && lat <= 33.3 && lon >= 34.2 && lon <= 35.9;\n  };\n\n  // Better middle point calculation using route distance\n  const findRouteMiddlePoint = routePoints => {\n    if (!routePoints || routePoints.length < 2) {\n      setSearchError('Route has insufficient points');\n      return;\n    }\n\n    // Filter out any points that are clearly outside Israel\n    const validPoints = routePoints.filter(point => isInIsrael(point[0], point[1]));\n    if (validPoints.length < routePoints.length) {\n      console.warn(`Filtered out ${routePoints.length - validPoints.length} points outside Israel`);\n    }\n    if (validPoints.length < 2) {\n      setSearchError('No valid route points in Israel');\n      return;\n    }\n\n    // Calculate the cumulative distances along the route\n    let totalDistance = 0;\n    const distances = [0]; // First point has 0 distance\n\n    for (let i = 1; i < validPoints.length; i++) {\n      const p1 = validPoints[i - 1];\n      const p2 = validPoints[i];\n\n      // Calculate the distance between consecutive points\n      const d = Math.sqrt(Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2));\n      totalDistance += d;\n      distances.push(totalDistance);\n    }\n\n    // Find the middle distance point\n    const middleDistance = totalDistance / 2;\n\n    // Find the segment containing the middle distance\n    let segmentIndex = 0;\n    while (segmentIndex < distances.length - 1 && distances[segmentIndex + 1] < middleDistance) {\n      segmentIndex++;\n    }\n\n    // Calculate the exact middle point using interpolation\n    let calculatedMiddlePoint;\n    if (segmentIndex < validPoints.length - 1) {\n      const p1 = validPoints[segmentIndex];\n      const p2 = validPoints[segmentIndex + 1];\n      const segmentLength = distances[segmentIndex + 1] - distances[segmentIndex];\n      const ratio = segmentLength ? (middleDistance - distances[segmentIndex]) / segmentLength : 0;\n      calculatedMiddlePoint = [p1[0] + ratio * (p2[0] - p1[0]), p1[1] + ratio * (p2[1] - p1[1])];\n    } else {\n      // Fallback to the middle point if calculation fails\n      calculatedMiddlePoint = validPoints[Math.floor(validPoints.length / 2)];\n    }\n\n    // Verify the calculated point is in Israel\n    if (!isInIsrael(calculatedMiddlePoint[0], calculatedMiddlePoint[1])) {\n      console.error(\"Calculated middle point is outside Israel, using midpoint of array instead\");\n      calculatedMiddlePoint = validPoints[Math.floor(validPoints.length / 2)];\n    }\n\n    // Set the middle point and log to console\n    setMiddlePoint(calculatedMiddlePoint);\n    console.log(\"Line 60 middle point:\", calculatedMiddlePoint);\n\n    // Update map to show the middle point\n    setMapCenterLocal(calculatedMiddlePoint);\n  };\n\n  // Memoize optimized route shape to avoid unnecessary recalculations\n  const optimizedRouteShape = useMemo(() => {\n    return routeShape;\n  }, [routeShape]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '100vh',\n      width: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(MapControls, {\n      searchQuery: searchQuery,\n      setSearchQuery: setSearchQuery,\n      handleSearch: handleSearch,\n      handleKeyPress: handleKeyPress,\n      handleSetStartPoint: handleSetStartPoint,\n      handleSetDestinationPoint: handleSetDestinationPoint,\n      searchError: searchError,\n      positionAddress: positionAddress,\n      destinationAddress: destinationAddress\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleShowMiddlePoint,\n      style: {\n        position: 'absolute',\n        bottom: '60px',\n        left: '10px',\n        zIndex: 1000,\n        padding: '8px 12px',\n        backgroundColor: '#9c27b0',\n        color: 'white',\n        border: 'none',\n        borderRadius: '4px',\n        cursor: 'pointer'\n      },\n      title: \"Show middle point of Line 60 route\",\n      children: \"Show Line 60 Middle Point\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapControlPanel, {\n      showRoutePanel: showRoutePanel,\n      setShowRoutePanel: setShowRoutePanel,\n      optimizedRouteShape: optimizedRouteShape,\n      handleShowRoutePanel: handleShowRoutePanel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: mapCenter,\n      zoom: 13,\n      style: {\n        height: '100%',\n        width: '100%'\n      },\n      zoomControl: false,\n      whenReady: () => setMapReady(true),\n      preferCanvas: true,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UpdateMapView, {\n        position: mapCenter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TrackMapMovement, {\n        setMapCenter: setMapCenterLocal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapEffect, {\n        routeShape: optimizedRouteShape\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(RouteLayer, {\n        routeShape: routeShape,\n        route: route\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MarkersLayer, {\n        position: position,\n        positionAddress: positionAddress,\n        destination: destination,\n        destinationAddress: destinationAddress,\n        mapCenter: mapCenter,\n        vehicleMarkers: vehicleMarkers,\n        stops: stops,\n        selectedStop: selectedStop,\n        handleSetStartPoint: handleSetStartPoint,\n        middlePoint: middlePoint // Pass the middle point to MarkersLayer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 304,\n    columnNumber: 5\n  }, this);\n}\n_s(MapView, \"ZGFlxIddd9G91l9/B7yPpEBDmvc=\", false, function () {\n  return [useMapHandlers];\n});\n_c = MapView;\nexport default MapView;\nvar _c;\n$RefreshReg$(_c, \"MapView\");","map":{"version":3,"names":["useEffect","useState","useMemo","MapContainer","TileLayer","TrackMapMovement","UpdateMapView","fetchAddress","configureDefaultLeafletIcons","MapControls","useMapHandlers","MapEffect","RouteLayer","MarkersLayer","MapControlPanel","jsxDEV","_jsxDEV","MapView","latitude","longitude","destination","onDestinationSet","startingPoint","mapCenter","initialMapCenter","setMapCenter","vehicleMarkers","routeShape","stops","selectedStop","center","defaultStartingPoint","defaultDestination","calculateRoute","onRouteCalculated","_s","position","setPosition","route","setRoute","mapReady","setMapReady","setMapCenterLocal","showRoutePanel","setShowRoutePanel","middlePoint","setMiddlePoint","searchQuery","setSearchQuery","searchError","setSearchError","positionAddress","destinationAddress","setPositionAddress","setDestinationAddress","handleSearch","handleSetStartPoint","handleSetDestinationPoint","handleKeyPress","handleFindRoute","Array","isArray","length","handleFindRouteClick","console","log","handleShowRoutePanel","routeData","error","handleShowMiddlePoint","middleIndex","Math","floor","calculatedMiddlePoint","group","groupEnd","response","fetch","data","json","middleStop","lat","lon","name","id","sequence","hardcodedMiddlePoint","fallbackPoint","setTimeout","isInIsrael","findRouteMiddlePoint","routePoints","validPoints","filter","point","warn","totalDistance","distances","i","p1","p2","d","sqrt","pow","push","middleDistance","segmentIndex","segmentLength","ratio","optimizedRouteShape","style","height","width","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","bottom","left","zIndex","padding","backgroundColor","color","border","borderRadius","cursor","title","zoom","zoomControl","whenReady","preferCanvas","url","attribution","_c","$RefreshReg$"],"sources":["/home/yaniv/101_coding/publicTransportation/react/public-transportation/src/MapView.js"],"sourcesContent":["import { useEffect, useState, useMemo } from 'react';\nimport './App.css';\nimport { MapContainer, TileLayer } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { TrackMapMovement, UpdateMapView, fetchAddress } from './components/map/MapUtilities';\nimport { configureDefaultLeafletIcons } from './components/map/MapMarkers';\nimport MapControls from './components/map/MapControls';\nimport useMapHandlers from './hooks/useMapHandlers';\nimport MapEffect from './components/map/MapEffect';\nimport RouteLayer from './components/map/RouteLayer';\nimport MarkersLayer from './components/map/MarkersLayer';\nimport MapControlPanel from './components/map/MapControlPanel';\n\n// Configure default Leaflet icons\nconfigureDefaultLeafletIcons();\n\nfunction MapView({ \n  latitude, \n  longitude, \n  destination, \n  onDestinationSet, \n  startingPoint,\n  mapCenter: initialMapCenter,\n  setMapCenter,\n  vehicleMarkers = [],\n  routeShape = null,\n  stops = [],\n  selectedStop = null,\n  center,\n  defaultStartingPoint,\n  defaultDestination,\n  calculateRoute,\n  onRouteCalculated\n}) {\n  // Use default starting point if provided\n  const [position, setPosition] = useState(defaultStartingPoint || [latitude, longitude]);\n  const [route, setRoute] = useState(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [mapCenter, setMapCenterLocal] = useState(center || initialMapCenter || [latitude, longitude]);\n  const [showRoutePanel, setShowRoutePanel] = useState(false);\n  // Add state for middle point\n  const [middlePoint, setMiddlePoint] = useState(null);\n\n  // Update external map center when local state changes\n  useEffect(() => {\n    if (setMapCenter) {\n      setMapCenter(mapCenter);\n    }\n  }, [mapCenter, setMapCenter]);\n\n  // Set the default destination if provided and no destination is set\n  useEffect(() => {\n    if (defaultDestination && (!destination || !destination[0])) {\n      onDestinationSet(defaultDestination);\n    }\n  }, [defaultDestination, destination, onDestinationSet]);\n\n  // Use custom hook for map handlers\n  const {\n    searchQuery,\n    setSearchQuery,\n    searchError,\n    setSearchError,  // Add this line to extract setSearchError from the hook\n    positionAddress,\n    destinationAddress,\n    setPositionAddress,\n    setDestinationAddress,\n    handleSearch,\n    handleSetStartPoint,\n    handleSetDestinationPoint,\n    handleKeyPress,\n    handleFindRoute\n  } = useMapHandlers(position, setPosition, destination, onDestinationSet, setMapCenterLocal, mapCenter);\n\n  // When destination changes, ensure it's properly set\n  useEffect(() => {\n    if (destination && Array.isArray(destination) && destination.length === 2) {\n      // Destination is valid\n      fetchAddress(destination[0], destination[1], setDestinationAddress);\n    }\n  }, [destination]);\n\n  // When position changes\n  useEffect(() => {\n    if (position && Array.isArray(position) && position.length === 2) {\n      fetchAddress(position[0], position[1], setPositionAddress);\n    }\n  }, [position]);\n\n  // Add effect to respond to calculateRoute changes\n  useEffect(() => {\n    if (calculateRoute && position && destination) {\n      // Actually calculate the route using the position as starting point\n      handleFindRouteClick();\n      \n      // Let parent know we've processed the request\n      if (onRouteCalculated) {\n        onRouteCalculated();\n      }\n    }\n  }, [calculateRoute, position, destination]);\n\n  // Log routeShape when it changes to debug\n  useEffect(() => {\n    if (routeShape) {\n      console.log(\"Route shape received in MapView:\", routeShape.length, \"points\");\n    }\n  }, [routeShape]);\n\n  // If we have a proper route shape, show the route panel with RouteMapView\n  const handleShowRoutePanel = () => {\n    if (routeShape && routeShape.length > 0) {\n      setShowRoutePanel(true);\n    }\n  };\n\n  // Handle clicking the \"Find Route\" button\n  const handleFindRouteClick = async () => {\n    if (destination) {\n      // Make sure we're using the current user position, not map center\n      console.log(\"Finding route from user position to destination\");\n      const routeData = await handleFindRoute();\n      if (routeData) {\n        setRoute(routeData);\n        console.log(\"Setting route with\", routeData.length, \"points from\", position, \"to\", destination);\n      }\n    } else {\n      console.error(\"No destination set\");\n    }\n  };\n\n  // Function to calculate and set the middle point of line 60's route\n  const handleShowMiddlePoint = async () => {\n    try {\n      setSearchError('Fetching Line 60 route data...');\n      \n      // First approach: Use route shape points if available\n      if (routeShape && routeShape.length > 0) {\n        const middleIndex = Math.floor(routeShape.length / 2);\n        const calculatedMiddlePoint = routeShape[middleIndex];\n        setMiddlePoint(calculatedMiddlePoint);\n        \n        // Log detailed information to console for debugging\n        console.group(\"Line 60 Middle Point Information\");\n        console.log(\"Middle point coordinates:\", calculatedMiddlePoint);\n        console.log(\"Total route points:\", routeShape.length);\n        console.log(\"Middle point index:\", middleIndex);\n        console.log(\"Method used: Route shape\");\n        console.groupEnd();\n        \n        // Update map center to show the middle point\n        setMapCenterLocal(calculatedMiddlePoint);\n        return;\n      }\n      \n      // Second approach: Fetch stops data for Line 60\n      const response = await fetch('/api/stops-data.php?line=60');\n      const data = await response.json();\n      \n      if (data.stops && data.stops.length > 0) {\n        // Get the middle stop from the stops array\n        const stops = data.stops;\n        const middleIndex = Math.floor(stops.length / 2);\n        const middleStop = stops[middleIndex];\n        const calculatedMiddlePoint = [middleStop.lat, middleStop.lon];\n        \n        setMiddlePoint(calculatedMiddlePoint);\n        \n        // Log detailed information about the middle stop to console\n        console.group(\"Line 60 Middle Stop Information\");\n        console.log(\"Middle stop:\", middleStop.name);\n        console.log(\"Stop ID:\", middleStop.id);\n        console.log(\"Coordinates:\", calculatedMiddlePoint);\n        console.log(\"Stop sequence:\", middleStop.sequence);\n        console.log(\"Position in route:\", `${middleIndex + 1} of ${stops.length} stops`);\n        console.log(\"Method used: Stops data\");\n        \n        // Log all stops for detailed analysis\n        console.log(\"All stops on route:\", stops);\n        console.groupEnd();\n        \n        // Update map center to show the middle stop\n        setMapCenterLocal(calculatedMiddlePoint);\n      } else {\n        // Third approach: Hardcode known middle points for Line 60\n        const hardcodedMiddlePoint = [32.0729, 34.8046]; // Middle point for Line 60 in Ramat Gan\n        setMiddlePoint(hardcodedMiddlePoint);\n        \n        console.group(\"Line 60 Middle Point Information\");\n        console.log(\"Middle point coordinates (hardcoded):\", hardcodedMiddlePoint);\n        console.log(\"Method used: Hardcoded coordinates\");\n        console.log(\"Note: This is an approximation as API data was unavailable\");\n        console.groupEnd();\n        \n        // Update map center to show the hardcoded middle point\n        setMapCenterLocal(hardcodedMiddlePoint);\n      }\n    } catch (error) {\n      console.error('Error finding middle point:', error);\n      setSearchError('Error finding middle point');\n      \n      // Still provide some fallback coordinates in case of error\n      const fallbackPoint = [32.0729, 34.8046]; // Known approximate middle point for Line 60\n      setMiddlePoint(fallbackPoint);\n      setMapCenterLocal(fallbackPoint);\n      \n      setTimeout(() => setSearchError(null), 3000);\n    }\n  };\n\n  // Helper function to validate coordinates are in Israel\n  const isInIsrael = (lat, lon) => {\n    // Rough bounding box for Israel\n    return lat >= 29.5 && lat <= 33.3 && lon >= 34.2 && lon <= 35.9;\n  };\n\n  // Better middle point calculation using route distance\n  const findRouteMiddlePoint = (routePoints) => {\n    if (!routePoints || routePoints.length < 2) {\n      setSearchError('Route has insufficient points');\n      return;\n    }\n\n    // Filter out any points that are clearly outside Israel\n    const validPoints = routePoints.filter(point => \n      isInIsrael(point[0], point[1])\n    );\n\n    if (validPoints.length < routePoints.length) {\n      console.warn(`Filtered out ${routePoints.length - validPoints.length} points outside Israel`);\n    }\n\n    if (validPoints.length < 2) {\n      setSearchError('No valid route points in Israel');\n      return;\n    }\n\n    // Calculate the cumulative distances along the route\n    let totalDistance = 0;\n    const distances = [0]; // First point has 0 distance\n    \n    for (let i = 1; i < validPoints.length; i++) {\n      const p1 = validPoints[i-1];\n      const p2 = validPoints[i];\n      \n      // Calculate the distance between consecutive points\n      const d = Math.sqrt(\n        Math.pow(p2[0] - p1[0], 2) + \n        Math.pow(p2[1] - p1[1], 2)\n      );\n      \n      totalDistance += d;\n      distances.push(totalDistance);\n    }\n    \n    // Find the middle distance point\n    const middleDistance = totalDistance / 2;\n    \n    // Find the segment containing the middle distance\n    let segmentIndex = 0;\n    while (segmentIndex < distances.length - 1 && distances[segmentIndex + 1] < middleDistance) {\n      segmentIndex++;\n    }\n    \n    // Calculate the exact middle point using interpolation\n    let calculatedMiddlePoint;\n    \n    if (segmentIndex < validPoints.length - 1) {\n      const p1 = validPoints[segmentIndex];\n      const p2 = validPoints[segmentIndex + 1];\n      \n      const segmentLength = distances[segmentIndex + 1] - distances[segmentIndex];\n      const ratio = segmentLength ? (middleDistance - distances[segmentIndex]) / segmentLength : 0;\n      \n      calculatedMiddlePoint = [\n        p1[0] + ratio * (p2[0] - p1[0]),\n        p1[1] + ratio * (p2[1] - p1[1])\n      ];\n    } else {\n      // Fallback to the middle point if calculation fails\n      calculatedMiddlePoint = validPoints[Math.floor(validPoints.length / 2)];\n    }\n\n    // Verify the calculated point is in Israel\n    if (!isInIsrael(calculatedMiddlePoint[0], calculatedMiddlePoint[1])) {\n      console.error(\"Calculated middle point is outside Israel, using midpoint of array instead\");\n      calculatedMiddlePoint = validPoints[Math.floor(validPoints.length / 2)];\n    }\n    \n    // Set the middle point and log to console\n    setMiddlePoint(calculatedMiddlePoint);\n    console.log(\"Line 60 middle point:\", calculatedMiddlePoint);\n\n    // Update map to show the middle point\n    setMapCenterLocal(calculatedMiddlePoint);\n  };\n\n  // Memoize optimized route shape to avoid unnecessary recalculations\n  const optimizedRouteShape = useMemo(() => {\n    return routeShape;\n  }, [routeShape]);\n\n  return (\n    <div style={{ height: '100vh', width: '100%' }}>\n      {/* Search and controls */}\n      <MapControls \n        searchQuery={searchQuery}\n        setSearchQuery={setSearchQuery}\n        handleSearch={handleSearch}\n        handleKeyPress={handleKeyPress}\n        handleSetStartPoint={handleSetStartPoint}\n        handleSetDestinationPoint={handleSetDestinationPoint}\n        searchError={searchError}\n        positionAddress={positionAddress}\n        destinationAddress={destinationAddress}\n      />\n      \n      {/* Middle point button for line 60 */}\n      <button\n        onClick={handleShowMiddlePoint}\n        style={{\n          position: 'absolute',\n          bottom: '60px',\n          left: '10px',\n          zIndex: 1000,\n          padding: '8px 12px',\n          backgroundColor: '#9c27b0',\n          color: 'white',\n          border: 'none',\n          borderRadius: '4px',\n          cursor: 'pointer'\n        }}\n        title=\"Show middle point of Line 60 route\"\n      >\n        Show Line 60 Middle Point\n      </button>\n      \n      {/* Route panel and controls */}\n      <MapControlPanel\n        showRoutePanel={showRoutePanel}\n        setShowRoutePanel={setShowRoutePanel}\n        optimizedRouteShape={optimizedRouteShape}\n        handleShowRoutePanel={handleShowRoutePanel}\n      />\n      \n      <MapContainer \n        center={mapCenter} \n        zoom={13} \n        style={{ height: '100%', width: '100%' }} \n        zoomControl={false}\n        whenReady={() => setMapReady(true)}\n        preferCanvas={true}\n      >\n        <TileLayer\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        <UpdateMapView position={mapCenter} />\n        <TrackMapMovement setMapCenter={setMapCenterLocal} />\n        <MapEffect routeShape={optimizedRouteShape} />\n        \n        {/* All route polylines */}\n        <RouteLayer \n          routeShape={routeShape}\n          route={route}\n        />\n        \n        {/* All map markers */}\n        <MarkersLayer\n          position={position}\n          positionAddress={positionAddress}\n          destination={destination}\n          destinationAddress={destinationAddress}\n          mapCenter={mapCenter}\n          vehicleMarkers={vehicleMarkers}\n          stops={stops}\n          selectedStop={selectedStop}\n          handleSetStartPoint={handleSetStartPoint}\n          middlePoint={middlePoint}  // Pass the middle point to MarkersLayer\n        />\n      </MapContainer>\n    </div>\n  );\n}\n\nexport default MapView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}